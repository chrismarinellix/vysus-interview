<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="Vysus Group Power Systems Engineering Technical Challenge - Test your expertise and join Australia's premier renewable energy team">
  <meta name="author" content="Vysus Group">
  <title>Join Vysus Group - Are You Ready?</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ö°</text></svg>">

  <!-- Critical: Ensure page loads even with restrictions -->
  <script>
    // Immediate page initialization
    (function() {
      'use strict';

      // Show loading indicator immediately
      document.addEventListener('DOMContentLoaded', function() {
        console.log('Vysus Challenge: Page loaded successfully');

        // Remove loading class from body
        document.body.classList.remove('loading');

        // Verify critical elements exist
        setTimeout(function() {
          if (!document.getElementById('landingScreen')) {
            console.error('Critical elements missing - check HTML structure');
            alert('There was an issue loading the page. Please refresh or try opening in a different browser (Chrome, Firefox, or Edge recommended).');
          }
        }, 100);
      });

      // Handle all errors gracefully
      window.addEventListener('error', function(e) {
        console.warn('Resource loading error (non-critical):', e.message);
        // Continue working - images are optional
        return true;
      }, true);

      // Prevent blank screen on script errors
      window.addEventListener('unhandledrejection', function(e) {
        console.warn('Unhandled promise rejection:', e.reason);
        return true;
      });

    })();

    // Polyfills for older browsers
    if (!String.prototype.padStart) {
      String.prototype.padStart = function padStart(targetLength, padString) {
        targetLength = targetLength >> 0;
        padString = String(typeof padString !== 'undefined' ? padString : ' ');
        if (this.length >= targetLength) {
          return String(this);
        } else {
          targetLength = targetLength - this.length;
          if (targetLength > padString.length) {
            padString += padString.repeat(targetLength / padString.length);
          }
          return padString.slice(0, targetLength) + String(this);
        }
      };
    }

    if (!Array.prototype.forEach) {
      Array.prototype.forEach = function(callback, thisArg) {
        for (var i = 0; i < this.length; i++) {
          callback.call(thisArg, this[i], i, this);
        }
      };
    }

    // Ensure smooth scrolling works
    if (!('scrollBehavior' in document.documentElement.style)) {
      window.scrollTo = function(x, y) {
        if (typeof x === 'object') {
          window.scroll(x.left || 0, x.top || 0);
        } else {
          window.scroll(x, y);
        }
      };
    }
  </script>
  <style>
/* Vysus Group Official Brand Colors */
:root {
  --vysus-neon: #00E3A9;
  --vysus-green: #005454;
  --vysus-white: #ffffff;
  --vysus-snow: #f8f8f8;
  --vysus-ice: #ededed;
  --vysus-rock: #485559;
  --vysus-night: #1d1d1b;
  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
  --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
  --gold: #FFD700;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  line-height: 1.6;
  color: var(--vysus-rock);
  min-height: 100vh;
  overflow-x: hidden;
  /* Ensure body always has a background */
  background: linear-gradient(135deg, #f8f8f8 0%, #ededed 100%);
}

/* Loading state - prevents blank screen */
body.loading {
  background: #005454;
  color: white;
}

body.loading::before {
  content: 'Loading Vysus Group Challenge...';
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 1.5rem;
  font-weight: 700;
  text-align: center;
}

/* Fallback for browsers without backdrop-filter support */
@supports not (backdrop-filter: blur(10px)) {
  .promo-content,
  .quiz-container,
  .results-content,
  .role-card,
  .leader-card,
  .submit-results-section,
  .answer-option,
  .quiz-instructions,
  .score-stat,
  .category-score {
    background: rgba(255, 255, 255, 0.98) !important;
    border: 2px solid rgba(0, 227, 169, 0.4) !important;
  }

  .promo-header,
  .challenge-callout,
  .performance-message {
    background: rgba(0, 84, 84, 0.95) !important;
    border: 2px solid rgba(0, 227, 169, 0.5) !important;
  }

  .choice-card {
    background: rgba(0, 227, 169, 0.9) !important;
    border: 3px solid rgba(255, 255, 255, 0.5) !important;
  }

  .score-flashcard {
    background: rgba(255, 215, 0, 0.98) !important;
    border: 2px solid rgba(255, 255, 255, 0.6) !important;
  }

  .form-group input,
  .form-group textarea {
    background: rgba(255, 255, 255, 0.98) !important;
    border: 2px solid rgba(0, 227, 169, 0.4) !important;
  }
}

/* Fallback for browsers that block external images */
@supports not (background-attachment: fixed) {
  #landingScreen,
  #promoScreen,
  #quizScreen,
  #resultsScreen {
    background-attachment: scroll !important;
  }
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 20px 20px 20px;
}

#landingScreen .container {
  padding: 20px;
}

#promoScreen .container {
  padding: 0 20px 20px 20px !important;
  margin-top: 0 !important;
}

#quizScreen .container,
#resultsScreen .container {
  padding-top: 20px;
}

/* Screens - Simplified for maximum compatibility */
.screen {
  display: none !important;
  opacity: 0;
  min-height: auto;
  visibility: hidden;
}

.screen.active {
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
  animation: fadeInScreen 0.8s ease forwards;
}

.screen.fadeOut {
  animation: fadeOutScreen 0.5s ease forwards;
}

/* Ensure landing screen shows immediately and fills viewport */
#landingScreen {
  min-height: 100vh !important;
}

#landingScreen.active {
  display: flex !important;
}

/* Other screens should fit content, not force full height */
#promoScreen,
#quizScreen,
#resultsScreen {
  min-height: auto !important;
  padding: 0 !important;
  margin: 0 !important;
}

@keyframes fadeInScreen {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes fadeOutScreen {
  from { opacity: 1; }
  to { opacity: 0; }
}

/* Landing Screen with Background */
#landingScreen {
  position: relative;
  display: flex !important; /* Force display */
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  /* Fallback solid color - ALWAYS works */
  background-color: #003d3d !important;
  /* Gradient overlay - works if CSS gradients supported */
  background-image: linear-gradient(135deg, #001a1a 0%, #003d3d 50%, #005454 100%);
  /* Image with gradient overlay (if image loads and isn't blocked) */
  background-image:
    linear-gradient(135deg, rgba(0, 26, 26, 0.7) 0%, rgba(0, 61, 61, 0.65) 50%, rgba(0, 84, 84, 0.6) 100%),
    url('https://images.unsplash.com/photo-1509391366360-2e959784a276?w=2400&q=90&fm=jpg&fit=crop');
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  overflow: hidden;
}

#landingScreen::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: radial-gradient(circle at 30% 50%, rgba(0, 227, 169, 0.15) 0%, transparent 50%);
  pointer-events: none;
}

/* Animated Energy Background */
.energy-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background:
    linear-gradient(135deg, rgba(0, 227, 169, 0.15) 0%, transparent 50%),
    radial-gradient(circle at 20% 50%, rgba(0, 227, 169, 0.2) 0%, transparent 50%),
    radial-gradient(circle at 80% 50%, rgba(0, 84, 84, 0.25) 0%, transparent 50%);
  z-index: 0;
}

.energy-particles {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}

.particle {
  position: absolute;
  width: 4px;
  height: 4px;
  background: var(--vysus-neon);
  border-radius: 50%;
  opacity: 0.6;
  animation: float 20s infinite;
}

.particle:nth-child(1) { left: 10%; animation-delay: 0s; }
.particle:nth-child(2) { left: 20%; animation-delay: 2s; }
.particle:nth-child(3) { left: 30%; animation-delay: 4s; }
.particle:nth-child(4) { left: 40%; animation-delay: 6s; }
.particle:nth-child(5) { left: 50%; animation-delay: 8s; }
.particle:nth-child(6) { left: 60%; animation-delay: 10s; }
.particle:nth-child(7) { left: 70%; animation-delay: 12s; }
.particle:nth-child(8) { left: 80%; animation-delay: 14s; }
.particle:nth-child(9) { left: 90%; animation-delay: 16s; }

@keyframes float {
  0% { transform: translateY(100vh) scale(0); opacity: 0; }
  10% { opacity: 0.6; }
  90% { opacity: 0.6; }
  100% { transform: translateY(-100vh) scale(1); opacity: 0; }
}

.landing-content {
  position: relative;
  z-index: 10;
  text-align: center;
  color: white;
  max-width: 900px;
  padding: 40px 20px;
}

.landing-logo {
  font-size: 5rem;
  margin-bottom: 20px;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.05); opacity: 0.9; }
}

.landing-content h1 {
  font-size: 3.5rem;
  font-weight: 800;
  margin-bottom: 20px;
  text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.3);
  line-height: 1.2;
}

.landing-content .question {
  font-size: 2rem;
  margin-bottom: 50px;
  opacity: 0.95;
  font-weight: 600;
}

.choice-cards {
  display: flex;
  gap: 30px;
  justify-content: center;
  flex-wrap: wrap;
  margin-top: 40px;
}

.choice-card {
  background: rgba(0, 227, 169, 0.15);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border: 2px solid rgba(0, 227, 169, 0.3);
  border-radius: 25px;
  padding: 50px 60px;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  min-width: 250px;
  box-shadow:
    0 8px 32px rgba(0, 0, 0, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.choice-card:hover {
  transform: translateY(-10px) scale(1.05);
  box-shadow:
    0 20px 60px rgba(0, 227, 169, 0.5),
    0 0 40px rgba(0, 227, 169, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
  background: rgba(0, 227, 169, 0.25);
  border-color: rgba(0, 227, 169, 0.6);
}

.choice-card.yes {
  border-color: rgba(0, 227, 169, 0.4);
}

.choice-card.no {
  border-color: rgba(255, 82, 82, 0.4);
  background: rgba(255, 82, 82, 0.15);
}

.choice-card.no:hover {
  box-shadow:
    0 20px 60px rgba(255, 82, 82, 0.5),
    0 0 40px rgba(255, 82, 82, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
  background: rgba(255, 82, 82, 0.25);
  border-color: rgba(255, 82, 82, 0.6);
}

.choice-card .icon {
  font-size: 4rem;
  margin-bottom: 15px;
  display: block;
}

.choice-card .label {
  font-size: 2rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 2px;
}

.choice-card.disappear {
  animation: cardDisappear 0.8s ease forwards;
}

@keyframes cardDisappear {
  0% {
    transform: scale(1) rotateY(0deg);
    opacity: 1;
  }
  50% {
    transform: scale(1.2) rotateY(90deg);
    opacity: 0.5;
  }
  100% {
    transform: scale(0) rotateY(180deg);
    opacity: 0;
  }
}

/* Promotional Screen */
#promoScreen {
  /* Fallback solid color - ALWAYS works */
  background-color: #f8f8f8 !important;
  /* Gradient fallback */
  background-image: linear-gradient(135deg, #f8f8f8 0%, #ededed 100%);
  /* Image with gradient overlay (if image loads) */
  background-image:
    linear-gradient(135deg, rgba(248, 248, 248, 0.4) 0%, rgba(237, 237, 237, 0.3) 100%),
    url('https://images.unsplash.com/photo-1617478755490-e21232a5eeaf?w=2400&q=90&fm=jpg&fit=crop');
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  padding: 0 !important;
  margin: 0 !important;
  position: relative;
}

#promoScreen::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: radial-gradient(circle at 70% 30%, rgba(0, 227, 169, 0.1) 0%, transparent 50%);
  pointer-events: none;
  z-index: 0;
}

#promoScreen .container {
  position: relative;
  z-index: 1;
  padding-top: 0 !important;
  margin-top: 0 !important;
}

.promo-header {
  background: rgba(0, 84, 84, 0.75);
  backdrop-filter: blur(30px) saturate(180%);
  -webkit-backdrop-filter: blur(30px) saturate(180%);
  color: white;
  padding: 40px 30px;
  border-radius: 25px;
  text-align: center;
  margin-top: 0;
  margin-bottom: 25px;
  box-shadow:
    0 8px 32px rgba(0, 0, 0, 0.25),
    inset 0 1px 0 rgba(255, 255, 255, 0.1),
    0 0 80px rgba(0, 227, 169, 0.2);
  border: 1px solid rgba(0, 227, 169, 0.2);
  position: relative;
  overflow: hidden;
}

.promo-header::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(45deg, rgba(0, 227, 169, 0.2) 0%, transparent 70%);
  pointer-events: none;
}

.promo-header > * {
  position: relative;
  z-index: 1;
}

.promo-header h1 {
  font-size: 3rem;
  font-weight: 800;
  margin-bottom: 15px;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
}

.promo-header .subtitle {
  font-size: 1.6rem;
  opacity: 0.95;
}

.promo-content {
  background: rgba(255, 255, 255, 0.7);
  backdrop-filter: blur(30px) saturate(180%);
  -webkit-backdrop-filter: blur(30px) saturate(180%);
  border-radius: 25px;
  padding: 50px;
  box-shadow:
    0 8px 32px rgba(0, 0, 0, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
  border: 1px solid rgba(255, 255, 255, 0.5);
  margin-bottom: 30px;
}

.promo-content h2 {
  color: var(--vysus-green);
  font-size: 2.2rem;
  margin-bottom: 20px;
  font-weight: 700;
  padding-bottom: 15px;
  border-bottom: 3px solid var(--vysus-neon);
}

.promo-content h3 {
  color: var(--vysus-green);
  font-size: 1.5rem;
  margin-top: 30px;
  margin-bottom: 15px;
  font-weight: 700;
}

.promo-content p {
  font-size: 1.15rem;
  line-height: 1.8;
  margin-bottom: 20px;
}

.payment-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 25px;
  margin: 30px 0;
}

.payment-card {
  background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
  border: 3px solid var(--gold);
  border-radius: 15px;
  padding: 30px;
  text-align: center;
  box-shadow: var(--shadow-lg);
}

.payment-card .role {
  font-size: 1.2rem;
  font-weight: 700;
  color: var(--vysus-green);
  margin-bottom: 20px;
}

.payment-card .amount {
  font-size: 2.5rem;
  font-weight: 800;
  color: var(--gold);
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
  margin-bottom: 10px;
}

.payment-card .currencies {
  font-size: 0.95rem;
  color: var(--vysus-rock);
  opacity: 0.8;
}

.role-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
  gap: 25px;
  margin: 30px 0;
}

.role-card {
  background: rgba(230, 250, 245, 0.6);
  backdrop-filter: blur(25px) saturate(180%);
  -webkit-backdrop-filter: blur(25px) saturate(180%);
  border: 1px solid rgba(0, 227, 169, 0.3);
  border-radius: 20px;
  padding: 30px;
  box-shadow:
    0 8px 32px rgba(0, 0, 0, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.4);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.role-card:hover {
  transform: translateY(-8px);
  box-shadow:
    0 12px 48px rgba(0, 227, 169, 0.2),
    0 0 40px rgba(0, 227, 169, 0.15),
    inset 0 1px 0 rgba(255, 255, 255, 0.5);
  background: rgba(230, 250, 245, 0.75);
  border-color: rgba(0, 227, 169, 0.5);
}

.role-card .icon {
  font-size: 3rem;
  margin-bottom: 15px;
}

.role-card h4 {
  color: var(--vysus-green);
  font-size: 1.6rem;
  margin-bottom: 20px;
  font-weight: 700;
}

.role-card ul {
  list-style: none;
  padding: 0;
}

.role-card li {
  padding: 10px 0;
  padding-left: 30px;
  position: relative;
}

.role-card li::before {
  content: '‚úì';
  position: absolute;
  left: 0;
  color: var(--vysus-neon);
  font-weight: 700;
  font-size: 1.3rem;
}

.leaders-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 25px;
  margin: 30px 0;
}

.leader-card {
  background: rgba(230, 250, 245, 0.65);
  backdrop-filter: blur(25px) saturate(180%);
  -webkit-backdrop-filter: blur(25px) saturate(180%);
  border: 1px solid rgba(0, 227, 169, 0.3);
  border-radius: 20px;
  padding: 30px;
  box-shadow:
    0 8px 32px rgba(0, 0, 0, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.4);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.leader-card:hover {
  transform: translateY(-8px) scale(1.02);
  box-shadow:
    0 12px 48px rgba(0, 227, 169, 0.2),
    0 0 40px rgba(0, 227, 169, 0.15),
    inset 0 1px 0 rgba(255, 255, 255, 0.5);
  background: rgba(230, 250, 245, 0.8);
  border-color: rgba(0, 227, 169, 0.5);
}

.leader-card .icon {
  font-size: 3rem;
  margin-bottom: 15px;
  display: block;
}

.leader-card h4 {
  color: var(--vysus-green);
  font-size: 1.4rem;
  margin-bottom: 5px;
  font-weight: 700;
}

.leader-card .title {
  color: var(--vysus-neon);
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 15px;
  display: block;
}

.leader-card .quote {
  font-style: italic;
  font-size: 0.95rem;
  line-height: 1.6;
  color: var(--vysus-rock);
  border-left: 3px solid var(--vysus-neon);
  padding-left: 15px;
  margin: 15px 0;
}

.challenge-callout {
  background: rgba(255, 152, 0, 0.7);
  backdrop-filter: blur(30px) saturate(180%);
  -webkit-backdrop-filter: blur(30px) saturate(180%);
  color: white;
  padding: 50px 40px;
  border-radius: 25px;
  text-align: center;
  box-shadow:
    0 8px 32px rgba(255, 111, 0, 0.3),
    0 0 80px rgba(255, 152, 0, 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
  margin-top: 40px;
  border: 1px solid rgba(255, 255, 255, 0.3);
}

.challenge-callout h2 {
  color: white;
  border: none;
  font-size: 2.5rem;
  margin-bottom: 20px;
  padding: 0;
}

.challenge-callout p {
  font-size: 1.3rem;
  margin-bottom: 20px;
  line-height: 1.8;
}

.challenge-callout .warning {
  background: rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  padding: 20px;
  border-radius: 15px;
  margin: 20px 0;
  border-left: 5px solid rgba(255, 255, 255, 0.8);
  border: 1px solid rgba(255, 255, 255, 0.25);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2);
}

.accept-button {
  background: linear-gradient(135deg, var(--vysus-neon) 0%, #00ffbb 100%);
  color: var(--vysus-night);
  padding: 20px 60px;
  font-size: 1.6rem;
  font-weight: 800;
  border: none;
  border-radius: 50px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 10px 30px rgba(0, 227, 169, 0.4);
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-top: 20px;
}

.accept-button:hover {
  transform: translateY(-5px) scale(1.05);
  box-shadow: 0 15px 40px rgba(0, 227, 169, 0.6);
}

/* Quiz Screen */
#quizScreen {
  /* Fallback solid color - ALWAYS works */
  background-color: #e6faf5 !important;
  /* Gradient fallback */
  background-image: linear-gradient(135deg, #e6faf5 0%, #d0f0e8 100%);
  /* Image with gradient overlay (if image loads) */
  background-image:
    linear-gradient(135deg, rgba(0, 84, 84, 0.3) 0%, rgba(0, 227, 169, 0.2) 100%),
    url('https://images.unsplash.com/photo-1473341304170-971dccb5ac1e?w=2400&q=90&fm=jpg&fit=crop');
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  padding: 0;
  position: relative;
}

#quizScreen::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: radial-gradient(circle at 50% 50%, rgba(0, 227, 169, 0.1) 0%, transparent 70%);
  pointer-events: none;
}

.quiz-container {
  background: rgba(255, 255, 255, 0.75);
  backdrop-filter: blur(30px) saturate(180%);
  -webkit-backdrop-filter: blur(30px) saturate(180%);
  border-radius: 25px;
  padding: 30px;
  margin-top: 20px;
  box-shadow:
    0 8px 32px rgba(0, 0, 0, 0.15),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
  border: 1px solid rgba(255, 255, 255, 0.4);
  min-height: auto;
  position: relative;
  z-index: 10;
}

.quiz-instructions {
  background: rgba(255, 243, 224, 0.6);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border-left: 5px solid rgba(255, 152, 0, 0.8);
  border-radius: 15px;
  padding: 20px 25px;
  margin-bottom: 30px;
  text-align: center;
  box-shadow:
    0 4px 16px rgba(255, 152, 0, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
  border: 1px solid rgba(255, 152, 0, 0.2);
}

.quiz-instructions h3 {
  color: var(--vysus-green);
  font-size: 1.4rem;
  margin-bottom: 10px;
  font-weight: 700;
}

.quiz-instructions p {
  font-size: 1.05rem;
  line-height: 1.6;
  color: var(--vysus-rock);
  margin: 0;
}

.score-flashcard {
  position: fixed;
  top: 20px;
  right: 20px;
  background: rgba(255, 215, 0, 0.75);
  backdrop-filter: blur(25px) saturate(200%);
  -webkit-backdrop-filter: blur(25px) saturate(200%);
  color: var(--vysus-night);
  padding: 20px 30px;
  border-radius: 20px;
  box-shadow:
    0 8px 32px rgba(255, 215, 0, 0.4),
    0 0 60px rgba(255, 215, 0, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
  border: 1px solid rgba(255, 255, 255, 0.4);
  z-index: 1000;
  min-width: 150px;
  text-align: center;
  animation: slideIn 0.5s ease;
}

@keyframes slideIn {
  from { transform: translateX(200px); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

.score-flashcard .label {
  font-size: 0.9rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 5px;
}

.score-flashcard .points {
  font-size: 3rem;
  font-weight: 800;
  line-height: 1;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
}

.score-flashcard .question-count {
  font-size: 0.85rem;
  margin-top: 5px;
  opacity: 0.8;
}

.score-flashcard .timer {
  font-size: 0.9rem;
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid rgba(0, 0, 0, 0.2);
  font-weight: 600;
}

/* Encouragement Message */
.encouragement-message {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(0, 227, 169, 0.95);
  backdrop-filter: blur(30px);
  -webkit-backdrop-filter: blur(30px);
  color: white;
  padding: 30px 50px;
  border-radius: 20px;
  font-size: 1.8rem;
  font-weight: 700;
  text-align: center;
  z-index: 3000;
  box-shadow:
    0 10px 40px rgba(0, 227, 169, 0.5),
    0 0 80px rgba(0, 227, 169, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
  border: 1px solid rgba(255, 255, 255, 0.4);
  animation: encouragementPop 2s ease;
  pointer-events: none;
}

@keyframes encouragementPop {
  0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
  15% { opacity: 1; transform: translate(-50%, -50%) scale(1.05); }
  85% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
  100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
}

.point-popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 6rem;
  font-weight: 800;
  color: var(--vysus-neon);
  text-shadow: 0 0 20px rgba(0, 227, 169, 0.5);
  z-index: 2000;
  pointer-events: none;
  animation: popupFade 1s ease forwards;
}

@keyframes popupFade {
  0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
  50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
  100% { opacity: 0; transform: translate(-50%, -100%) scale(1); }
}

.progress-section {
  margin-bottom: 30px;
}

.progress-bar {
  width: 100%;
  height: 15px;
  background: var(--vysus-ice);
  border-radius: 10px;
  overflow: hidden;
  margin-bottom: 15px;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--vysus-neon) 0%, var(--vysus-green) 100%);
  border-radius: 10px;
  transition: width 0.5s ease;
}

.question-counter {
  text-align: center;
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--vysus-green);
  margin-bottom: 20px;
}

.category-badge {
  display: inline-block;
  background: rgba(0, 84, 84, 0.8);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  color: white;
  padding: 10px 25px;
  border-radius: 25px;
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 15px;
  margin-right: 10px;
  border: 1px solid rgba(0, 227, 169, 0.3);
  box-shadow: 0 4px 12px rgba(0, 84, 84, 0.2);
}

.difficulty-badge {
  display: inline-block;
  padding: 10px 25px;
  border-radius: 25px;
  font-size: 1rem;
  font-weight: 700;
  margin-bottom: 15px;
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.difficulty-badge.easy {
  background: rgba(76, 175, 80, 0.7);
  color: white;
  border-color: rgba(76, 175, 80, 0.5);
}

.difficulty-badge.medium {
  background: rgba(255, 152, 0, 0.75);
  color: white;
  border-color: rgba(255, 152, 0, 0.5);
}

.difficulty-badge.hard {
  background: rgba(244, 67, 54, 0.75);
  color: white;
  border-color: rgba(244, 67, 54, 0.5);
}

.question-text {
  font-size: 1.4rem;
  color: var(--vysus-night);
  font-weight: 600;
  line-height: 1.6;
  margin-bottom: 30px;
}

.answers-grid {
  display: grid;
  gap: 15px;
}

.answer-option {
  background: rgba(248, 249, 250, 0.6);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border: 1px solid rgba(0, 227, 169, 0.2);
  border-radius: 18px;
  padding: 25px;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  box-shadow:
    0 4px 16px rgba(0, 0, 0, 0.08),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

.answer-option:hover {
  border-color: rgba(0, 227, 169, 0.6);
  transform: translateX(8px) scale(1.01);
  box-shadow:
    0 8px 24px rgba(0, 227, 169, 0.15),
    0 0 30px rgba(0, 227, 169, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.4);
  background: rgba(230, 250, 245, 0.7);
}

.answer-option.selected {
  border-color: rgba(0, 227, 169, 0.7);
  background: rgba(230, 250, 245, 0.75);
  animation: selectPulse 0.3s ease;
  box-shadow:
    0 8px 24px rgba(0, 227, 169, 0.2),
    0 0 40px rgba(0, 227, 169, 0.15),
    inset 0 1px 0 rgba(255, 255, 255, 0.5);
}

@keyframes selectPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.02); }
}

.answer-label {
  font-weight: 700;
  color: var(--vysus-green);
  margin-right: 10px;
  font-size: 1.2rem;
}

.answer-text {
  font-size: 1.1rem;
  line-height: 1.7;
  color: var(--vysus-rock);
}

/* Results Screen */
#resultsScreen {
  /* Fallback solid color - ALWAYS works */
  background-color: #d0f0e8 !important;
  /* Gradient fallback */
  background-image: linear-gradient(135deg, #d0f0e8 0%, #e6faf5 100%);
  /* Image with gradient overlay (if image loads) - Beautiful grid-scale solar+BESS */
  background-image:
    linear-gradient(135deg, rgba(0, 84, 84, 0.3) 0%, rgba(0, 227, 169, 0.2) 100%),
    url('https://images.unsplash.com/photo-1624397640148-949b1732bb0a?w=2400&q=90&fm=jpg&fit=crop');
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  padding: 0;
  position: relative;
}

#resultsScreen::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: radial-gradient(circle at 60% 40%, rgba(0, 227, 169, 0.12) 0%, transparent 60%);
  pointer-events: none;
}

.results-content {
  background: rgba(255, 255, 255, 0.75);
  backdrop-filter: blur(30px) saturate(180%);
  -webkit-backdrop-filter: blur(30px) saturate(180%);
  border-radius: 25px;
  padding: 50px;
  box-shadow:
    0 8px 32px rgba(0, 0, 0, 0.15),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
  border: 1px solid rgba(255, 255, 255, 0.4);
  text-align: center;
  position: relative;
  z-index: 10;
}

.results-icon {
  font-size: 6rem;
  margin-bottom: 20px;
  animation: bounce 1s ease;
}

@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-20px); }
}

.results-content h2 {
  color: var(--vysus-green);
  font-size: 2.8rem;
  margin-bottom: 20px;
  font-weight: 700;
}

.final-score {
  font-size: 5rem;
  font-weight: 800;
  background: linear-gradient(135deg, var(--vysus-neon) 0%, var(--vysus-green) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin: 20px 0;
}

.score-breakdown {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin: 30px 0;
}

.score-stat {
  background: rgba(230, 250, 245, 0.6);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  padding: 25px;
  border-radius: 18px;
  border-left: 4px solid rgba(0, 227, 169, 0.8);
  border: 1px solid rgba(0, 227, 169, 0.25);
  box-shadow:
    0 4px 16px rgba(0, 0, 0, 0.08),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

.score-stat-value {
  font-size: 2.5rem;
  font-weight: 700;
  color: var(--vysus-green);
  display: block;
}

.score-stat-label {
  font-size: 1rem;
  color: var(--vysus-rock);
  margin-top: 5px;
}

.performance-message {
  background: rgba(0, 84, 84, 0.75);
  backdrop-filter: blur(30px) saturate(180%);
  -webkit-backdrop-filter: blur(30px) saturate(180%);
  color: white;
  padding: 40px;
  border-radius: 25px;
  margin: 30px 0;
  box-shadow:
    0 8px 32px rgba(0, 84, 84, 0.3),
    0 0 60px rgba(0, 227, 169, 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.15);
  border: 1px solid rgba(0, 227, 169, 0.25);
}

.performance-message h3 {
  font-size: 2.2rem;
  margin-bottom: 15px;
}

.performance-message p {
  font-size: 1.3rem;
  line-height: 1.8;
  opacity: 0.95;
}

.submit-results-section {
  background: rgba(230, 250, 245, 0.65);
  backdrop-filter: blur(25px) saturate(180%);
  -webkit-backdrop-filter: blur(25px) saturate(180%);
  border: 1px solid rgba(0, 227, 169, 0.3);
  border-radius: 25px;
  padding: 40px;
  margin: 30px 0;
  text-align: left;
  box-shadow:
    0 8px 32px rgba(0, 0, 0, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.4);
}

.submit-results-section h3 {
  color: var(--vysus-green);
  font-size: 2rem;
  margin-bottom: 20px;
  text-align: center;
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  font-weight: 600;
  color: var(--vysus-green);
  margin-bottom: 8px;
  font-size: 1.1rem;
}

.form-group input,
.form-group textarea {
  width: 100%;
  padding: 15px;
  background: rgba(255, 255, 255, 0.6);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border: 1px solid rgba(0, 227, 169, 0.2);
  border-radius: 12px;
  font-size: 1rem;
  font-family: inherit;
  transition: all 0.3s ease;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

.form-group input:focus,
.form-group textarea:focus {
  outline: none;
  border-color: rgba(0, 227, 169, 0.6);
  box-shadow:
    0 0 0 3px rgba(0, 227, 169, 0.15),
    inset 0 1px 0 rgba(255, 255, 255, 0.4);
  background: rgba(255, 255, 255, 0.75);
}

.form-group textarea {
  min-height: 100px;
  resize: vertical;
}

.file-upload {
  border: 3px dashed var(--vysus-ice);
  border-radius: 15px;
  padding: 30px;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s ease;
}

.file-upload:hover {
  border-color: var(--vysus-neon);
  background: rgba(0, 227, 169, 0.05);
}

.file-upload input[type="file"] {
  display: none;
}

.file-upload-label {
  font-size: 1.1rem;
  color: var(--vysus-green);
  font-weight: 600;
}

.submit-button {
  background: linear-gradient(135deg, var(--vysus-neon) 0%, var(--vysus-green) 100%);
  color: white;
  padding: 18px 50px;
  font-size: 1.3rem;
  font-weight: 700;
  border: none;
  border-radius: 50px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: var(--shadow-lg);
  width: 100%;
  margin-top: 10px;
}

.submit-button:hover {
  transform: translateY(-3px);
  box-shadow: 0 10px 20px rgba(0, 227, 169, 0.3);
}

.category-results {
  text-align: left;
  margin: 30px 0;
}

.category-results h3 {
  color: var(--vysus-green);
  font-size: 1.8rem;
  margin-bottom: 20px;
  text-align: center;
}

.category-score {
  background: rgba(248, 248, 248, 0.6);
  backdrop-filter: blur(15px) saturate(180%);
  -webkit-backdrop-filter: blur(15px) saturate(180%);
  padding: 15px 20px;
  border-radius: 12px;
  margin-bottom: 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border: 1px solid rgba(0, 227, 169, 0.15);
  box-shadow:
    0 2px 8px rgba(0, 0, 0, 0.05),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

.category-name {
  font-weight: 600;
  color: var(--vysus-rock);
}

.category-percentage {
  font-weight: 700;
  font-size: 1.2rem;
  color: var(--vysus-green);
}

/* Editable Question Elements */
.editable {
  outline: 2px dashed transparent;
  transition: all 0.3s ease;
  padding: 5px;
  border-radius: 5px;
}

.editable:hover {
  outline-color: rgba(0, 227, 169, 0.3);
  background: rgba(0, 227, 169, 0.05);
  cursor: text;
}

.editable:focus {
  outline-color: rgba(0, 227, 169, 0.6);
  background: rgba(0, 227, 169, 0.1);
}

.question-notes {
  background: rgba(255, 243, 224, 0.6);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border: 1px solid rgba(255, 152, 0, 0.3);
  border-radius: 15px;
  padding: 20px;
  margin-top: 30px;
  margin-bottom: 20px;
}

.question-notes h4 {
  color: var(--vysus-green);
  font-size: 1.1rem;
  margin-bottom: 10px;
  font-weight: 700;
}

.question-notes textarea {
  width: 100%;
  min-height: 100px;
  padding: 15px;
  background: rgba(255, 255, 255, 0.7);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 152, 0, 0.3);
  border-radius: 10px;
  font-family: inherit;
  font-size: 0.95rem;
  line-height: 1.6;
  resize: vertical;
}

.question-notes textarea:focus {
  outline: none;
  border-color: rgba(255, 152, 0, 0.6);
  box-shadow: 0 0 0 3px rgba(255, 152, 0, 0.1);
}

.edit-hint {
  font-size: 0.85rem;
  color: var(--vysus-rock);
  opacity: 0.7;
  font-style: italic;
  margin-top: 5px;
}

/* Access Screen Styles */
.access-form-container {
  background: rgba(0, 84, 84, 0.4);
  backdrop-filter: blur(30px) saturate(180%);
  -webkit-backdrop-filter: blur(30px) saturate(180%);
  border: 2px solid rgba(0, 227, 169, 0.3);
  border-radius: 25px;
  padding: 40px;
  max-width: 500px;
  margin: 0 auto;
  box-shadow:
    0 8px 32px rgba(0, 0, 0, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.access-form {
  display: flex;
  flex-direction: column;
  gap: 25px;
}

.access-input-group {
  position: relative;
}

.access-input {
  width: 100%;
  padding: 18px 20px;
  font-size: 1.2rem;
  border: 2px solid rgba(0, 227, 169, 0.4);
  border-radius: 15px;
  background: rgba(255, 255, 255, 0.1);
  color: white;
  outline: none;
  transition: all 0.3s ease;
  font-family: inherit;
}

.access-input::placeholder {
  color: rgba(255, 255, 255, 0.6);
}

.access-input:focus {
  border-color: var(--vysus-neon);
  background: rgba(255, 255, 255, 0.15);
  box-shadow: 0 0 20px rgba(0, 227, 169, 0.3);
}

.access-notice {
  background: rgba(255, 152, 0, 0.2);
  border: 1px solid rgba(255, 152, 0, 0.4);
  border-radius: 12px;
  padding: 15px 20px;
  font-size: 0.95rem;
  line-height: 1.6;
  color: rgba(255, 255, 255, 0.95);
  text-align: center;
}

.access-button {
  background: linear-gradient(135deg, var(--vysus-neon) 0%, #00ffbb 100%);
  color: var(--vysus-night);
  padding: 18px 40px;
  font-size: 1.4rem;
  font-weight: 800;
  border: none;
  border-radius: 50px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 10px 30px rgba(0, 227, 169, 0.4);
  text-transform: uppercase;
  letter-spacing: 1px;
}

.access-button:hover {
  transform: translateY(-5px) scale(1.02);
  box-shadow: 0 15px 40px rgba(0, 227, 169, 0.6);
}

.access-footer {
  margin-top: 30px;
  font-size: 0.95rem;
  opacity: 0.8;
}

.expired-message {
  background: rgba(255, 82, 82, 0.2);
  border: 1px solid rgba(255, 82, 82, 0.4);
  border-radius: 20px;
  padding: 30px;
  max-width: 500px;
  margin: 20px auto;
  font-size: 1.1rem;
  line-height: 1.7;
}

/* Global Timer Display */
.global-timer {
  position: fixed;
  top: 20px;
  left: 20px;
  background: rgba(255, 82, 82, 0.9);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  color: white;
  padding: 15px 25px;
  border-radius: 15px;
  font-weight: 700;
  font-size: 1.1rem;
  z-index: 2000;
  box-shadow: 0 4px 20px rgba(255, 82, 82, 0.4);
  border: 1px solid rgba(255, 255, 255, 0.2);
  display: none;
}

.global-timer.warning {
  animation: timerPulse 1s infinite;
  background: rgba(255, 50, 50, 0.95);
}

.global-timer.critical {
  animation: timerPulse 0.5s infinite;
  background: rgba(255, 0, 0, 0.95);
}

@keyframes timerPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

/* Responsive */
@media (max-width: 768px) {
  .landing-content h1 { font-size: 2.2rem; }
  .landing-content .question { font-size: 1.4rem; }
  .choice-cards { flex-direction: column; }
  .choice-card { min-width: 200px; }
  .promo-header h1 { font-size: 2rem; }
  .promo-content { padding: 30px 20px; }
  .role-cards, .leaders-grid, .payment-grid { grid-template-columns: 1fr; }
  .score-flashcard { position: static; margin-bottom: 20px; }
  .question-text { font-size: 1.2rem; }
  .access-form-container { padding: 25px; margin: 0 15px; }
  .global-timer { top: 10px; left: 10px; font-size: 0.95rem; padding: 10px 15px; }
}
  </style>
</head>
<body>
  <!-- Global Countdown Timer -->
  <div id="globalTimer" class="global-timer">‚è±Ô∏è Time Remaining: 60:00</div>

  <!-- Fallback for browsers with JavaScript disabled -->
  <noscript>
    <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: #005454; color: white; display: flex; align-items: center; justify-content: center; z-index: 10000; padding: 40px; text-align: center;">
      <div>
        <h1 style="font-size: 2.5rem; margin-bottom: 20px;">‚ö° Vysus Group Technical Challenge</h1>
        <p style="font-size: 1.3rem; margin-bottom: 20px;">JavaScript is required for this interactive challenge.</p>
        <p style="font-size: 1.1rem; margin-bottom: 30px;">Please enable JavaScript in your browser settings and refresh the page.</p>
        <p style="font-size: 1rem; opacity: 0.9;">Need help? Contact chris.marinelli@vysusgroup.com</p>
      </div>
    </div>
  </noscript>

  <!-- Access Gate Screen - Email Verification -->
  <div id="accessScreen" class="screen active" style="display: flex; opacity: 1; visibility: visible; min-height: 100vh; background-color: #003d3d;">
    <div class="energy-background"></div>
    <div class="energy-particles">
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
    </div>

    <div class="landing-content">
      <div class="landing-logo">üîê</div>
      <h1>Vysus Group</h1>
      <h1 style="font-size: 2.5rem; margin-top: -10px; color: var(--vysus-neon);">Technical Challenge Access</h1>
      <p class="question" style="margin-bottom: 30px;">Enter your email to begin your timed assessment</p>

      <div class="access-form-container">
        <form id="accessForm" class="access-form">
          <div class="access-input-group">
            <input type="email" id="candidateEmailAccess" required placeholder="your.email@example.com" class="access-input">
          </div>
          <p class="access-notice">
            ‚è±Ô∏è <strong>Important:</strong> Once you begin, you have <strong>60 minutes</strong> to complete the assessment.<br>
            The timer cannot be paused or reset.
          </p>
          <button type="submit" class="access-button">
            <span>üöÄ Begin Assessment</span>
          </button>
        </form>
      </div>

      <div class="access-footer">
        <p>Questions? Contact <a href="mailto:chris.marinelli@vysusgroup.com" style="color: var(--vysus-neon);">chris.marinelli@vysusgroup.com</a></p>
      </div>
    </div>
  </div>

  <!-- Session Expired Screen -->
  <div id="expiredScreen" class="screen" style="display: none; background-color: #003d3d;">
    <div class="energy-background"></div>
    <div class="landing-content">
      <div class="landing-logo">‚è∞</div>
      <h1 style="color: #ff5252;">Session Expired</h1>
      <p class="question" style="margin-bottom: 30px;">Your 60-minute assessment window has ended.</p>
      <div class="expired-message">
        <p>Your answers up to this point have been saved. If you would like to discuss your partial results or request a new assessment opportunity, please contact us.</p>
        <a href="mailto:chris.marinelli@vysusgroup.com?subject=Vysus Technical Challenge - Session Expired" class="access-button" style="display: inline-block; margin-top: 20px; text-decoration: none;">
          Contact Recruitment Team
        </a>
      </div>
    </div>
  </div>

  <!-- Landing Screen - Inline styles as backup for visibility -->
  <div id="landingScreen" class="screen" style="display: none; opacity: 0; visibility: hidden; min-height: 100vh; background-color: #003d3d;">
    <div class="energy-background"></div>
    <div class="energy-particles">
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
    </div>

    <div class="landing-content">
      <div class="landing-logo">‚ö°</div>
      <h1>Join Australia's Premier</h1>
      <h1 style="font-size: 3rem; margin-top: -10px; color: var(--vysus-neon);">Power and Energy Systems Team</h1>
      <p class="question">Are you ready to shape the future of renewable energy?</p>

      <div class="choice-cards">
        <div class="choice-card yes" onclick="acceptChallenge()">
          <span class="icon">üöÄ</span>
          <span class="label">Yes, I'm Ready!</span>
        </div>

        <div class="choice-card no" onclick="declineChallenge()">
          <span class="icon">üëã</span>
          <span class="label">Not Today</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Promotional Screen - Inline styles as backup -->
  <div id="promoScreen" class="screen" style="background-color: #f8f8f8; padding: 0; margin: 0;">
    <div class="container" style="padding-top: 0; margin-top: 0;">
      <div class="promo-header" style="margin-top: 0;">
        <h1>‚ö° Vysus Group Power Systems Engineers</h1>
        <p class="subtitle">Principal/Lead & Senior Level Opportunities</p>
      </div>

      <div class="promo-content">
        <h2>An Exceptional Opportunity Awaits You</h2>
        <p>Vysus Group is expanding our market-leading Power & Energy Systems team, and we want <strong>you</strong> to be part of it. Whether you're an experienced <strong>Principal/Lead Power Systems Engineer</strong> ready to lead teams and shape technical strategy, or a talented <strong>Senior Power Systems Engineer</strong> looking to grow your career - your expertise could help us build Australia's premier power systems engineering team.</p>

        <h3>Two Levels, One Mission - Where Do You Fit?</h3>
        <p>Whether you see yourself as a strategic leader or a technical delivery expert, we have the perfect role waiting for you:</p>

        <div class="role-cards">
          <div class="role-card">
            <span class="icon">üëî</span>
            <h4>Principal/Lead Power Systems Engineer</h4>
            <ul>
              <li><strong>Leadership Focus:</strong> Oversee multiple complex projects, drive technical direction, mentor teams</li>
              <li><strong>Strategic Impact:</strong> Business development, client relationship ownership, thought leadership</li>
              <li><strong>Technical Depth:</strong> Utility background ideal, publication experience valued, industry influence</li>
              <li><strong>Stakeholder Management:</strong> Direct engagement with AEMO, NSPs, major developers</li>
            </ul>
          </div>

          <div class="role-card">
            <span class="icon">‚ö°</span>
            <h4>Senior Power Systems Engineer</h4>
            <ul>
              <li><strong>Delivery Focus:</strong> Execute high-quality power systems studies, manage individual projects</li>
              <li><strong>Technical Skills:</strong> Power systems modelling expertise (PSS/E, PSCAD, PowerFactory)</li>
              <li><strong>Grid Connection:</strong> Deep understanding of NEM processes, compliance & standards</li>
              <li><strong>Collaboration:</strong> Work with developers, NSPs, AEMO on renewable energy projects</li>
            </ul>
          </div>
        </div>

        <h3>Your Future Mentors - Learn from the Best</h3>
        <p>You'll work alongside globally recognized technical experts who will personally mentor you and accelerate your career:</p>

        <div class="leaders-grid">
          <div class="leader-card">
            <span class="icon">üåè</span>
            <h4>Tony Morton</h4>
            <span class="title">Global Technical Lead</span>
            <p class="quote">"Tony's expertise in grid integration has shaped renewable energy policy across multiple continents. His mentorship transforms engineers into industry thought leaders. Working under his guidance means exposure to the most complex and innovative projects in the field."</p>
          </div>

          <div class="leader-card">
            <span class="icon">‚ö°</span>
            <h4>Robby Palackal</h4>
            <span class="title">Australian Technical Lead</span>
            <p class="quote">"Robby is renowned across Australia as the go-to expert for complex NER compliance and dynamic stability challenges. His deep technical knowledge combined with a collaborative mentoring approach ensures every team member grows into a subject matter expert. He's published extensively and is regularly consulted by AEMO and major NSPs."</p>
          </div>

          <div class="leader-card">
            <span class="icon">üî¨</span>
            <h4>Naveen Rajagopal</h4>
            <span class="title">Senior Principal Engineer</span>
            <p class="quote">"Naveen's expertise in advanced modeling techniques and system strength analysis is unmatched in the industry. His innovative approaches to solving low-SCR challenges have set new benchmarks. He actively mentors engineers through complex technical scenarios, ensuring knowledge transfer that accelerates careers."</p>
          </div>
        </div>

        <h3>What You'll Gain by Joining Us</h3>
        <p><strong>World-Class Mentorship:</strong> You'll learn directly from globally recognized technical leaders who are shaping the future of renewable integration across Australia, Malaysia, and India. Your professional development will be personally guided by industry experts.</p>

        <p><strong>Technical Excellence:</strong> You'll work on Australia's most advanced renewable projects - Grid-Forming BESS, hybrid solar+storage, Hydrogen electrolysers, weak grid scenarios, and system strength remediation. Your expertise will be challenged and expanded on every project.</p>

        <p><strong>Your Career Growth:</strong> Join a team with an unparalleled track record since 2002 in power systems studies and grid connections across the NEM. You'll be involved in a significant percentage of renewable generation projects connected to the Australian network - your work will directly shape the industry.</p>

        <p><strong>Flexibility & Impact:</strong> You'll enjoy remote working options across Australian capital cities with flexible arrangements that respect your expertise and autonomy. Every project you touch will contribute directly to Australia's renewable energy transformation.</p>
      </div>

      <div class="challenge-callout">
        <h2>‚ö†Ô∏è Are You Ready for Your Technical Challenge?</h2>
        <p>We're looking for engineers like you who can operate at the highest technical level. To proceed, you'll complete our <strong>Technical Excellence Assessment</strong> - a rigorous 30-question challenge that will test your depth of knowledge in the areas required for Principal and Senior roles.</p>

        <div class="warning">
          <p style="margin: 0; font-weight: 600; font-size: 1.4rem;">‚ö° Warning: This Test is Tough</p>
          <p style="margin: 10px 0 0 0;">Only candidates with deep, hands-on expertise in NER compliance, dynamic simulation, grid integration, and advanced power systems will score well. This assessment is designed to separate true technical excellence from surface-level knowledge. Don't worry if you don't get every question perfect - we're looking for engineers who can demonstrate mastery in key areas.</p>
        </div>

        <p><strong>After you complete the challenge</strong>, you'll see your results and performance breakdown. If you'd like to progress your application, you can submit your results directly to our specialist Vysus recruitment team. Your verified score will be included with your submission so we can match you to the right role.</p>

        <p style="font-size: 1.1rem; margin-top: 30px; font-weight: 600;">Ready to prove you belong among Australia's power systems elite?</p>

        <button class="accept-button" onclick="startChallenge()">Accept Your Challenge</button>
      </div>
    </div>
  </div>

  <!-- Quiz Screen - Inline styles as backup -->
  <div id="quizScreen" class="screen" style="background-color: #e6faf5;">
    <div class="score-flashcard">
      <div class="label">Points</div>
      <div class="points" id="scorePoints">0</div>
      <div class="question-count" id="scoreQuestionCount">Question 1/34</div>
      <div class="timer" id="quizTimer">‚è±Ô∏è 0:00</div>
    </div>

    <div class="container">
      <div class="quiz-container">
        <!-- Quiz Instructions -->
        <div class="quiz-instructions">
          <h3>üìù How This Works</h3>
          <p><strong>Simply select your answer</strong> from the options below. Once you click an answer, you'll automatically advance to the next question. Watch your score increase in the gold flashcard in the top-right corner. There's no going back, so trust your instincts and demonstrate your expertise!</p>
          <p style="margin-top: 20px; font-size: 1.3rem; font-weight: 800; color: var(--vysus-green); text-align: center; padding: 15px; background: rgba(0, 227, 169, 0.1); border-radius: 10px; border: 2px solid rgba(0, 227, 169, 0.3);">
            ‚úâÔ∏è IMPORTANT: After you finish, you can email your results directly to our Vysus recruitment team!
          </p>
        </div>

        <div class="progress-section">
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 3.33%"></div>
          </div>
          <div class="question-counter" id="questionCounter">Question 1 of 34</div>
        </div>

        <div style="margin-bottom: 25px;">
          <div class="category-badge" id="categoryBadge">NER Grid Code Compliance</div>
          <div class="difficulty-badge hard" id="difficultyBadge">üî• 100 Points</div>
        </div>

        <div class="question-section">
          <div class="question-text" id="questionText"></div>
        </div>

        <div class="answers-grid" id="answersGrid"></div>

        <!-- Internal Notes Section (hidden from candidates) -->
        <div class="question-notes" id="questionNotes" style="display: none;"></div>
      </div>
    </div>
  </div>

  <!-- Results Screen - Inline styles as backup -->
  <div id="resultsScreen" class="screen" style="background-color: #d0f0e8;">
    <div class="container">
      <div class="results-content">
        <div class="results-icon" id="resultsIcon">üèÜ</div>
        <h2>Challenge Complete!</h2>
        <div class="final-score" id="finalScore">0%</div>

        <div class="score-breakdown">
          <div class="score-stat">
            <span class="score-stat-value" id="correctCount">0</span>
            <span class="score-stat-label">Correct Answers</span>
          </div>
          <div class="score-stat">
            <span class="score-stat-value" id="totalPoints">0</span>
            <span class="score-stat-label">Total Points</span>
          </div>
          <div class="score-stat">
            <span class="score-stat-value" id="timeSpent">0:00</span>
            <span class="score-stat-label">Time Taken</span>
          </div>
        </div>

        <div class="performance-message" id="performanceMessage"></div>

        <!-- Submit Results Form -->
        <div class="submit-results-section">
          <h3>üìß Ready to Take the Next Step?</h3>
          <p style="text-align: center; margin-bottom: 30px; font-size: 1.1rem;">Interested in joining our team? Complete the form below to send your challenge results directly to our specialist recruitment team. We'll review your performance and be in touch to discuss how you can contribute to Australia's renewable energy future.</p>

          <form id="resultsForm" name="vysus-challenge-results" method="POST" data-netlify="true" netlify-honeypot="bot-field">
            <input type="hidden" name="form-name" value="vysus-challenge-results">
            <input type="hidden" name="bot-field">
            <input type="hidden" id="candidateScore" name="score">
            <input type="hidden" id="candidatePercentage" name="percentage">
            <input type="hidden" id="candidateAnswers" name="answers">
            <input type="hidden" id="candidateTimeTaken" name="timeTaken">
            <input type="hidden" id="candidateCategoryScores" name="categoryScores">

            <div class="form-group">
              <label>Full Name *</label>
              <input type="text" name="name" required placeholder="Enter your full name">
            </div>

            <div class="form-group">
              <label>Email Address *</label>
              <input type="email" id="candidateEmailResult" name="email" required placeholder="your.email@example.com">
            </div>

            <div class="form-group">
              <label>Phone Number *</label>
              <input type="tel" name="phone" required placeholder="+61 XXX XXX XXX">
            </div>

            <div class="form-group">
              <label>Current Location *</label>
              <input type="text" name="location" required placeholder="City, State">
            </div>

            <div class="form-group">
              <label>Years of Power Systems Experience *</label>
              <input type="number" name="experience" required placeholder="e.g., 5" min="0">
            </div>

            <div class="form-group">
              <label>LinkedIn Profile URL</label>
              <input type="url" name="linkedin" placeholder="https://linkedin.com/in/yourprofile">
            </div>

            <div class="form-group">
              <label>Why are you interested in joining Vysus Group? *</label>
              <textarea name="motivation" required placeholder="Tell us what attracts you to this opportunity..."></textarea>
            </div>

            <div class="form-group">
              <label>Resume/CV (Optional - PDF, DOC, DOCX - Max 5MB)</label>
              <div class="file-upload" onclick="document.getElementById('resumeFile').click()">
                <input type="file" id="resumeFile" name="resume" accept=".pdf,.doc,.docx">
                <div class="file-upload-label" id="fileUploadLabel">
                  üìé Click to upload your resume (optional)
                </div>
              </div>
            </div>

            <button type="submit" class="submit-button">Send Results to Vysus Recruitment</button>
          </form>
        </div>

        <div class="category-results">
          <h3>Your Performance by Category</h3>
          <div id="categoryBreakdown"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Quiz Data with variable points based on difficulty
    // Points: Easy=30, Medium=50, Hard=100
    const quizData = [
      // Leadership & Management Questions (New)
      {
        category: "Leadership & Management",
        difficulty: "medium",
        points: 50,
        question: "You're leading a team of 5 engineers on a critical 200MW solar+BESS project with a tight 8-week deadline. Two engineers are struggling with PSCAD modeling complexities, causing delays. As a Principal Engineer, what is your most effective leadership approach?",
        answers: [
          "Take over the PSCAD modeling yourself to ensure quality and meet the deadline.",
          "Pair the struggling engineers with your most experienced PSCAD expert for hands-on mentoring while adjusting the project timeline to accommodate their learning curve.",
          "Reassign the PSCAD work to external contractors and move the struggling engineers to less critical tasks.",
          "Set up daily checkpoint meetings to micromanage their progress until they improve."
        ],
        correct: 1
      },
      {
        category: "Leadership & Management",
        difficulty: "hard",
        points: 100,
        question: "A major client questions your team's R1 study conclusions during a stakeholder meeting with AEMO and the NSP present. The client claims your SCR analysis is overly conservative and will increase their project costs. You believe your analysis is correct but the client is influential. How do you handle this?",
        answers: [
          "Agree to revise the analysis to maintain client relationship and avoid conflict in front of AEMO.",
          "Defend your analysis with technical evidence, offer to walk through the methodology in detail, and propose an independent peer review if the client remains unconvinced.",
          "Defer to AEMO's opinion and modify your report based on their guidance.",
          "Stand firm on your analysis without explanation and refuse to discuss further modifications."
        ],
        correct: 1
      },
      {
        category: "Leadership & Management",
        difficulty: "medium",
        points: 50,
        question: "You're interviewing a candidate who has 8 years of utility experience but admits they've never used PSCAD, only PSS/E. Your project pipeline includes several GFM BESS projects requiring extensive PSCAD work. What's your assessment?",
        answers: [
          "Reject the candidate - PSCAD experience is non-negotiable for GFM work.",
          "Recognize their strong utility background as valuable, assess their learning ability and PSS/E depth, and consider them if they show strong fundamentals and willingness to learn PSCAD.",
          "Hire them but assign them only to PSS/E projects, avoiding PSCAD work entirely.",
          "Require them to complete a PSCAD course before making an offer."
        ],
        correct: 1
      },
      {
        category: "Leadership & Management",
        difficulty: "hard",
        points: 100,
        question: "Your team has just discovered a critical error in a submitted DMNT report that's already been reviewed by the NSP. The error doesn't affect the overall compliance conclusion but does impact one of the P/Q response curves. The project is on a tight timeline. What's your leadership decision?",
        answers: [
          "Don't mention it - the conclusion is still valid and raising it will cause delays.",
          "Immediately inform the client and NSP, take accountability, submit a revised report with corrected curves, and implement a quality review process to prevent future errors.",
          "Fix it quietly in the next revision without drawing attention to the mistake.",
          "Blame the junior engineer who made the error and have them fix it."
        ],
        correct: 1
      },
      {
        category: "NER Grid Code Compliance",
        difficulty: "hard",
        points: 100,
        question: "A Generator Proponent (GP) is submitting a DMAT report (R1). The study shows a 100ms overshoot in reactive power (Q) recovery under a 1.0 pu voltage step disturbance (S5.2.5.13). The GPS requires the response to settle within 40ms. What is the most likely cause and appropriate resolution in the model?",
        answers: [
          "The PPC (Plant Primary Controller)'s outer loop has excessively high proportional gain (Kp), necessitating a reduction in Kp and an increase in the integration time constant (Ti) on the inner control loops.",
          "The AVR (Automatic Voltage Regulator) has been incorrectly modeled with a Type 3 exciter, which must be swapped for a Type 4 and the inner loop transient gain increased.",
          "The Inner Current Controller (ICC)'s reactive current limitation setting is too restrictive, requiring the LVRT logic to be disabled during the voltage step.",
          "The PPC's voltage control droop is set too high, but the issue is non-critical as the NSP's concern is transient stability, not voltage recovery, which is handled in R2."
        ],
        correct: 0
      },
      {
        category: "NER Grid Code Compliance",
        difficulty: "hard",
        points: 100,
        question: "In an R2 Model Validation study for a 200MW BESS, the model fails to replicate the recorded active power (P) oscillation after a local fault clearance. The PPC is confirmed to be using Grid-Following (GFL) mode. What is the most probable issue requiring model modification?",
        answers: [
          "The SCR (Short Circuit Ratio) used in the test model is lower than the actual test SCR, requiring a 20ms delay on the inverter FRT logic.",
          "The AVR's measurement filter time constant is 10ms, which is too slow, necessitating a reduction to 5ms to match the recorded response.",
          "The Q injection strategy during the fault is incorrectly prioritizing active power priority, and the PPC must be tuned to prioritize Iq over Ip during the recovery phase.",
          "The inertia parameter in the GFL model is not representing the true system inertia contribution, requiring an increase in the BESS's virtual inertia setting."
        ],
        correct: 2
      },
      {
        category: "NER Grid Code Compliance",
        question: "NER S5.2.5.5 (Fault Ride Through) requires compliance with both LVRT and HVRT. During a LVRT study using a full system model, the inverter trips prematurely. The most likely cause is that the:",
        answers: [
          "PPC is losing synchronization due to an excessively fast PLL (Phase-Locked Loop) bandwidth (> 10Hz) under depressed voltage conditions.",
          "Reactive current priority (K-factor) is set to 0.5 which fails to provide the minimum required Q injection, leading to a FRT trip.",
          "The DC link voltage protection is configured for instantaneous tripping when the voltage drops below 0.8 pu, which is incorrect for LVRT.",
          "The NSP-provided R2 test methodology incorrectly specifies a CBF (Circuit Breaker Failure) fault, which the model cannot successfully clear."
        ],
        correct: 0
      },
      {
        category: "NER Grid Code Compliance",
        question: "A GP proposes a new PPC tuning for S5.2.5.13 (V&Q Control) that improves transient response but results in minor LVRT non-compliance in PSCAD. The most justifiable technical justification for the GPS to accept the tuning is that:",
        answers: [
          "The LVRT non-compliance is based on an overly conservative SMIB (Single-Machine Infinite Bus) model, which will be mitigated by the system-damping in the full network.",
          "The V&Q control is a primary operational requirement, whereas LVRT is a contingency, making the operational improvement strategically superior.",
          "The minor non-compliance falls within the NSP's MFRT (Maximum Fault Ride Through) tolerance of 10ms beyond the required voltage-time curve.",
          "The tuning maintains the K-factor at 2.0 throughout the fault, thus overriding any instantaneous LVRT trip logic."
        ],
        correct: 0
      },
      {
        category: "NER Grid Code Compliance",
        question: "NER S5.2.5.15 addresses frequency control. A 250MW Solar Farm is being assessed for MFRT. The most crucial PPC parameter to tune to demonstrate capability under this clause is the:",
        answers: [
          "Inverter's PLL bandwidth, which must be reduced to 0.5 Hz to ensure frequency stability.",
          "Inverter's Active Power Frequency Droop Setting (3%-5% typical), used to provide FDR (Frequency Disturbance Ride-Through).",
          "Inverter's LVRT threshold setting, as low voltage is the cause of most frequency events.",
          "PPC's V&Q droop to ensure sufficient voltage support during frequency excursions."
        ],
        correct: 1
      },
      {
        category: "Dynamic Simulation & Software",
        question: "When modeling a large wind farm in PSCAD, the engineer observes non-characteristic, high-frequency oscillations (50Hz-100Hz) under normal operating conditions. What is the most likely modeling error in the PSCAD setup?",
        answers: [
          "The PLL control gains are too low, causing a slow and oscillatory current response.",
          "The PCC (Point of Common Coupling) is incorrectly modeled as an ideal voltage source, ignoring the actual grid impedance.",
          "The Inverter control system sampling time step is too large (50 Œºs), leading to numerical instability in the EMT model.",
          "The DC Link Capacitor is underrated, leading to excessive voltage ripple."
        ],
        correct: 2
      },
      {
        category: "Dynamic Simulation & Software",
        question: "In a PSSE Dynamic Stability simulation, you are running a large-scale power system with multiple new IBRs. The simulation reports a FRT trip for a 200MW BESS. Upon inspection, the PSS/E generic IBR model is using a fixed Q injection priority (constant K-factor). To align with best practice and the OEM's control strategy, you should:",
        answers: [
          "Modify the model to ensure Q priority is maintained for 100ms then switch to P priority for faster recovery.",
          "Change the model to use a dynamic K-factor that is a function of the instantaneous AC voltage magnitude.",
          "Reduce the overall system SCR in the PSS/E network to reflect worst-case conditions.",
          "Switch from the PSS/E generic REEC model to a REPC model for improved PPC representation."
        ],
        correct: 1
      },
      {
        category: "Dynamic Simulation & Software",
        question: "For a Senior Engineer working on R1 studies, what is the most valuable application of Python scripting?",
        answers: [
          "Developing an AI algorithm to optimize the PPC tuning parameters for S5.2.5.13.",
          "Automating the batch execution of 50+ contingency cases in PSSE and post-processing the raw DSN output to extract P/Q rise/settling times for the final report.",
          "Replacing the PSCAD master library with a fully Python-based, object-oriented electromagnetic transients program.",
          "Creating a GUI for junior engineers to input OEM data, thus eliminating all manual data entry into PSSE."
        ],
        correct: 1
      },
      {
        category: "Dynamic Simulation & Software",
        question: "When moving from a SMIB model to a full network model for a transient stability study, what is the most common reason the SMIB model can fail to initialize or show a more stable response than the full network?",
        answers: [
          "The SMIB model's infinite bus has a fixed SCR of 1.0, which is always lower than the full network SCR.",
          "The SMIB model lacks the inter-area oscillation modes and SCR dependency, which can cause the PLL to de-synchronize in the full model.",
          "The SMIB model uses an aggregated REEC/REPC structure, which ignores the collector network impedances present in the full model.",
          "The SMIB's large equivalent inertia masks the IBRs' reliance on system strength."
        ],
        correct: 1
      },
      {
        category: "Advanced Technical Challenges",
        question: "During a harmonic assessment (S5.2.5.11), a 13th harmonic voltage V‚ÇÅ‚ÇÉ at the PCC is found to be 15% over the GPS limit. The grid-side impedance at this frequency is dominated by the system's parallel resonance. What is the most effective and common mitigation strategy?",
        answers: [
          "Increase the inverter's PWM switching frequency to shift the harmonic generation to a higher order.",
          "Request the NSP to decrease the fault level (SCR) at the PCC to shift the grid-side resonance.",
          "Install a C-type or High-Pass passive filter tuned close to 13th harmonic, with a damping resistor to dampen the resonance.",
          "Tune the PPC's voltage control droop to 0.5% to reduce the inverter's THD."
        ],
        correct: 2
      },
      {
        category: "Advanced Technical Challenges",
        question: "In a severely low-SCR environment (SCR<2.0), a GFL inverter-based plant may exhibit Sub-Synchronous Oscillations (SSO). Which control feature modification is the OEM most likely to propose to successfully mitigate this instability?",
        answers: [
          "Decreasing the PPC's inner-loop proportional gain (Kp).",
          "Implementing a Band-Pass Filter (BPF) or a Notch Filter within the PLL and/or current control loop, centered at the SSO frequency.",
          "Increasing the DC link capacitor size to suppress the SSO from the AC side.",
          "Switching the PPC from Q-priority to P-priority during all dynamic events."
        ],
        correct: 1
      },
      {
        category: "Advanced Technical Challenges",
        question: "Which core function of a Grid-Forming (GFM) inverter makes it fundamentally better suited than a Grid-Following (GFL) inverter in a system with very low or zero system inertia?",
        answers: [
          "GFM inverters can inject 1.5 pu reactive current during a fault, whereas GFL is limited to 1.0 pu.",
          "GFM inverters use a droop-based control to establish and maintain a local frequency and voltage magnitude reference without needing a PLL.",
          "GFM inverters are required to participate in MFRT for 100% of the voltage profile.",
          "GFM inverters utilize an external SCR measurement to adjust their inner-loop gains autonomously."
        ],
        correct: 1
      },
      {
        category: "Advanced Technical Challenges",
        question: "A Principal Engineer is conducting a Contingency Assessment (S5.2.5.7). The team discovers an unplanned 3rd-party BESS is due to be commissioned prior to their project. How should this new information be handled in the R1 study?",
        answers: [
          "Ignore the BESS and proceed, as only committed generators are required.",
          "Include the BESS as a committed generator in the base case model, using public GPS data for its P/Q capability and dynamic model.",
          "Delay the R1 submission and request the BESS's full R2 model from the NSP via AEMO.",
          "Only include the BESS's Power Factor (PF) contribution to the load flow, as its dynamic model is irrelevant for R1."
        ],
        correct: 1
      },
      {
        category: "Advanced Technical Challenges",
        question: "What is the most critical function of a PPC (Plant Primary Controller) in an Australian IBR project?",
        answers: [
          "Managing the NSP's revenue by optimizing market bids based on PCC output.",
          "Aggregating individual inverter commands to manage total active and reactive power output at the PCC in compliance with the GPS.",
          "Running the R2 model validation tests on the real-time SCADA system.",
          "Providing a low-latency WAN link between the power plant and the AEMO control room."
        ],
        correct: 1
      },
      {
        category: "Consultancy & Project Management",
        question: "A Senior Consultant is asked to scope a new R0 study for a 150MW PV farm. The client insists on a 6-week timeline. Based on typical industry expectations, the most critical risk to manage and communicate to the client is:",
        answers: [
          "The complexity of running the PSCAD EMT model, which will require 80% of the time.",
          "The difficulty in obtaining the necessary NSP and AEMO model data, which is an external dependency.",
          "The iterative nature of the R0 study, specifically the time required for DMNT tuning and the subsequent NSP feedback cycle on the preliminary GPS.",
          "The need to hire a Python expert to script the PSSE contingencies, as the team lacks this skill."
        ],
        correct: 2
      },
      {
        category: "Consultancy & Project Management",
        question: "When mentoring a junior engineer on dynamic studies, the most important initial concept to instill to prevent major errors in R1 model creation is:",
        answers: [
          "The difference between kV and MVA.",
          "The difference between p.u. values based on the machine base and the system base, and ensuring all OEM parameters are correctly converted before model entry.",
          "How to use the PSSE LF (Load Flow) solution to find the AC voltage angle.",
          "The PPC's role in FRT and its impact on DC link stability."
        ],
        correct: 1
      },
      {
        category: "Consultancy & Project Management",
        question: "What is the primary characteristic of an effective technical leader in a fast-paced power systems consultancy environment?",
        answers: [
          "Someone who micromanages every technical task to ensure 100% accuracy.",
          "A leader who sets clear expectations/deadlines, provides autonomy for technical execution, and supports professional growth into niche areas.",
          "An individual who only focuses on winning new bids and delegates all project management.",
          "A manager with 20+ years of solely academic experience in power systems theory."
        ],
        correct: 1
      },
      {
        category: "BESS & Transformer Modeling",
        question: "An R2 model validation test involves a sudden energization of a 330/33kV transformer. The model shows excessive magnetizing inrush current that causes the 330kV protection to trip. What is the most likely cause for this model mismatch?",
        answers: [
          "The PSCAD model is using a Type 1 transformer component, which lacks inrush representation.",
          "The transformer's B-H magnetizing curve (saturation data) is incorrectly modeled as a linear function, or the remnant flux has been neglected in the initialization.",
          "The transformer's impedance values (R and X) are too high, increasing the inrush current magnitude.",
          "The system X/R ratio is too low, damping the inrush current faster than in reality."
        ],
        correct: 1
      },
      {
        category: "BESS & Transformer Modeling",
        question: "A 100MW BESS project is being assessed. What is the most technically complex aspect of BESS modeling for a dynamic study compared to a PV farm model?",
        answers: [
          "BESS models require the DC link to be explicitly modeled with the battery state-of-charge.",
          "BESS models require explicit modeling of P and Q setpoints to ensure they are four-quadrant capable (¬±P and ¬±Q) simultaneously, and correctly represent the inner DC control dynamics.",
          "BESS is only GFL, while PV can be GFM.",
          "The BESS FRT logic is simpler because it only operates in discharge mode."
        ],
        correct: 1
      },
      {
        category: "Hybrid & Emerging Technologies",
        question: "In a Hybrid project (e.g., PV and BESS connected to a single PCC), what is the most critical element requiring careful tuning to ensure the system passes S5.2.5.13 (V&Q Control)?",
        answers: [
          "Ensuring the PV and BESS inverters use the same OEM model structure.",
          "Tuning the two separate PPC controllers (one for PV, one for BESS) and their co-ordination logic to manage their P/Q response at the PCC correctly, especially when one resource is limited.",
          "Ensuring the BESS only operates in charging mode when PV is generating.",
          "Running the simulation in DIgSILENT, as PSSE cannot handle hybrid systems."
        ],
        correct: 1
      },
      {
        category: "Hybrid & Emerging Technologies",
        question: "In a grid study context, a Hydrogen Electrolyser primarily appears as which type of electrical load?",
        answers: [
          "A GFM generation source, due to its requirement for stable DC power.",
          "A highly dynamic, non-linear Rectifier load with significant harmonic content, requiring V&Q support.",
          "A passive resistive load equivalent to its rated MW consumption.",
          "A constant power factor inductive load, similar to a motor."
        ],
        correct: 1
      },
      {
        category: "Hybrid & Emerging Technologies",
        question: "For a Principal Engineer tasked with the technical scope of an R1 study, which task is the most advanced and often deferred to the most experienced engineer?",
        answers: [
          "Setting up the R0 load flow base case.",
          "Determining the system-side impedance data (e.g., K-factor analysis and SCR range) and defining the critical fault locations for dynamic assessment.",
          "Generating the final DMNT report document.",
          "Checking the HVRT performance against S5.2.5.5."
        ],
        correct: 1
      },
      {
        category: "Hybrid & Emerging Technologies",
        question: "What are the key differences a Senior Engineer would look for when comparing R1 (Model Validation) to R2 (Physical Test Results)?",
        answers: [
          "R1 uses a generic REEC model, while R2 uses a custom OEM model.",
          "R1 is based on a SMIB model, while R2 is always a full network model.",
          "R1 is a model-to-model comparison (DMNT vs. DMOT), while R2 is a model-to-measurement comparison, testing the model's ability to replicate real-world physical injection test results.",
          "R1 includes Harmonics, but R2 focuses only on Transient Stability."
        ],
        correct: 2
      },
      {
        category: "Hybrid & Emerging Technologies",
        question: "A candidate mentions that they are strong in 'outer loop control' but not 'sub-transient timeframe.' In the context of IBRs, this means they primarily focus on:",
        answers: [
          "Protection coordination and relay settings, but not PPC.",
          "PPC V/Q droop, MFRT response, and Frequency regulation (100ms-seconds), but not the fast current controller loops (Œºs-ms).",
          "Load flow analysis and short circuit analysis, but not transient stability.",
          "DIgSILENT studies, but not PSCAD studies."
        ],
        correct: 1
      },
      {
        category: "Hybrid & Emerging Technologies",
        question: "Which DIgSILENT capability would a Principal Engineer be most likely to use for a complex, wide-area stability study that PSSE may struggle with?",
        answers: [
          "The ability to script using Python.",
          "The native, integrated Harmonic and EMT simulation capability.",
          "The detailed Eigenvalue Analysis tool to determine oscillation modes, damping and modal participation factors across the entire network.",
          "Its superior graphical user interface."
        ],
        correct: 2
      },
      {
        category: "Advanced Control & Integration",
        question: "In the context of LVRT, what does PPC 'freezing' refer to?",
        answers: [
          "The PPC stops communicating with SCADA during the fault.",
          "The PPC holds its active and reactive power setpoints fixed for a short duration during the fault to simplify the inverter's control and prioritize Iq injection.",
          "The PPC reboots due to a software error.",
          "The PPC command voltage becomes zero, leading to the inverter trip."
        ],
        correct: 1
      },
      {
        category: "Advanced Control & Integration",
        question: "An engineer states they are looking to leave their current role because they are 'not getting exposure to new technologies like GFM.' This is a strong fit for a consultancy like Vysus because:",
        answers: [
          "Consultancies are not required to follow NER rules on GFM.",
          "GFM is an academic topic, and consultancies provide training.",
          "The nature of consulting means working on novel, first-of-a-kind projects where GFM is being actively implemented and tested to solve system strength challenges.",
          "Internal roles offer less variety and are more focused on long-term maintenance."
        ],
        correct: 2
      },
      {
        category: "Advanced Control & Integration",
        question: "What is the main drawback of using a SMIB model for R1 studies, which necessitates the eventual move to a full network model?",
        answers: [
          "It cannot model the PPC.",
          "It is inaccurate for load flow studies.",
          "It fails to capture the interactions with other nearby generators, inter-area oscillation modes, and the accurate fault profile variations across a wide area of the network.",
          "It only works for DIgSILENT, not PSSE."
        ],
        correct: 2
      },
      {
        category: "Advanced Control & Integration",
        question: "In a project managing R1 deliverables, the most complex aspect of the DMNT report is typically:",
        answers: [
          "The PCC site map and equipment list.",
          "The calculation of maximum reactive power output.",
          "The justification of the PPC/Inverter tuning parameters used to achieve GPS compliance, and showing the P/Q response curves for all critical NER clauses.",
          "The O&M manual for the IBR."
        ],
        correct: 2
      },
      {
        category: "Advanced Control & Integration",
        question: "When analyzing power system stability in the presence of multiple wind farms, which phenomenon is most critical to evaluate for sub-synchronous resonance (SSR)?",
        answers: [
          "The interaction between series capacitor compensation and wind turbine generators' control systems.",
          "The harmonic distortion introduced by PWM converters at the point of interconnection.",
          "The impact of transmission line impedance on voltage regulation during peak generation.",
          "The reactive power support capability during normal operating conditions."
        ],
        correct: 0
      }
    ];

    // Verify page loaded correctly
    console.log('Vysus Challenge: Initializing quiz data...');
    console.log('Total questions loaded:', quizData.length);

    // Add default points to questions without explicit points
    quizData.forEach(function(q) {
      if (!q.points) {
        // Default points based on category complexity
        if (q.category.includes('Leadership') || q.category.includes('Advanced') || q.category.includes('NER')) {
          q.points = 100; // Hard questions
          q.difficulty = 'hard';
        } else if (q.category.includes('Consultancy') || q.category.includes('BESS') || q.category.includes('Hybrid')) {
          q.points = 50; // Medium questions
          q.difficulty = 'medium';
        } else {
          q.points = 30; // Easier questions
          q.difficulty = 'easy';
        }
      }
    });

    // Calculate total possible points
    const totalPossiblePoints = quizData.reduce(function(sum, q) { return sum + q.points; }, 0);
    console.log('Total possible points:', totalPossiblePoints);

    // State Management
    let currentQuestion = 0;
    let score = 0;
    let userAnswers = [];
    let startTime = null;
    let timerInterval = null;
    let lastEncouragementQuestion = -5; // Track when last encouragement was shown

    // Access Control Variables
    let candidateEmail = '';
    let sessionStartTime = null;
    let globalTimerInterval = null;
    const SESSION_DURATION = 60 * 60 * 1000; // 60 minutes in milliseconds

    // Initialize page when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
      console.log('Vysus Challenge: DOM ready, initializing...');

      // Check for existing session
      const savedSession = sessionStorage.getItem('vysusSession');
      if (savedSession) {
        const session = JSON.parse(savedSession);
        const elapsed = Date.now() - session.startTime;

        if (elapsed < SESSION_DURATION) {
          // Resume existing session
          candidateEmail = session.email;
          sessionStartTime = session.startTime;
          console.log('Resuming session for:', candidateEmail);

          // Hide access screen, show landing
          document.getElementById('accessScreen').style.display = 'none';
          document.getElementById('accessScreen').classList.remove('active');

          const landingScreen = document.getElementById('landingScreen');
          landingScreen.style.display = 'flex';
          landingScreen.style.opacity = '1';
          landingScreen.style.visibility = 'visible';
          landingScreen.classList.add('active');

          // Start the global countdown timer
          startGlobalTimer();
        } else {
          // Session expired
          sessionStorage.removeItem('vysusSession');
          showExpiredScreen();
        }
      } else {
        // No session - show access screen
        const accessScreen = document.getElementById('accessScreen');
        if (accessScreen) {
          console.log('Access screen ready');
          accessScreen.style.display = 'flex';
          accessScreen.style.opacity = '1';
          accessScreen.style.visibility = 'visible';
        }
      }

      // Setup access form handler
      const accessForm = document.getElementById('accessForm');
      if (accessForm) {
        accessForm.addEventListener('submit', function(e) {
          e.preventDefault();
          const emailInput = document.getElementById('candidateEmailAccess');
          candidateEmail = emailInput.value.trim();

          if (candidateEmail && validateEmail(candidateEmail)) {
            // Start session
            sessionStartTime = Date.now();
            sessionStorage.setItem('vysusSession', JSON.stringify({
              email: candidateEmail,
              startTime: sessionStartTime
            }));

            console.log('Session started for:', candidateEmail);

            // Transition to landing screen
            transitionToScreen('accessScreen', 'landingScreen', function() {
              startGlobalTimer();
            });
          } else {
            alert('Please enter a valid email address.');
          }
        });
      }
    });

    // Email validation helper
    function validateEmail(email) {
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return re.test(email);
    }

    // Start global countdown timer
    function startGlobalTimer() {
      const timerElement = document.getElementById('globalTimer');
      timerElement.style.display = 'block';

      function updateGlobalTimer() {
        const elapsed = Date.now() - sessionStartTime;
        const remaining = SESSION_DURATION - elapsed;

        if (remaining <= 0) {
          clearInterval(globalTimerInterval);
          clearInterval(timerInterval); // Stop quiz timer too
          sessionStorage.removeItem('vysusSession');

          // Auto-submit partial results if quiz was started
          if (userAnswers.length > 0) {
            autoSubmitPartialResults();
          }

          showExpiredScreen();
          return;
        }

        const minutes = Math.floor(remaining / 60000);
        const seconds = Math.floor((remaining % 60000) / 1000);
        timerElement.textContent = `‚è±Ô∏è Time Remaining: ${minutes}:${String(seconds).padStart(2, '0')}`;

        // Warning states
        if (remaining < 5 * 60 * 1000) { // Less than 5 minutes
          timerElement.classList.add('critical');
          timerElement.classList.remove('warning');
        } else if (remaining < 10 * 60 * 1000) { // Less than 10 minutes
          timerElement.classList.add('warning');
          timerElement.classList.remove('critical');
        }
      }

      updateGlobalTimer(); // Initial update
      globalTimerInterval = setInterval(updateGlobalTimer, 1000);
    }

    // Show expired screen
    function showExpiredScreen() {
      // Hide all screens
      document.querySelectorAll('.screen').forEach(screen => {
        screen.style.display = 'none';
        screen.classList.remove('active');
      });

      // Hide global timer
      document.getElementById('globalTimer').style.display = 'none';

      // Show expired screen
      const expiredScreen = document.getElementById('expiredScreen');
      expiredScreen.style.display = 'flex';
      expiredScreen.style.opacity = '1';
      expiredScreen.style.visibility = 'visible';
      expiredScreen.classList.add('active');
    }

    // Auto-submit partial results when session expires
    function autoSubmitPartialResults() {
      console.log('Auto-submitting partial results...');
      // This will be handled by the form submission logic
    }

    // Transition between screens with smooth animation
    function transitionToScreen(fromScreenId, toScreenId, callback) {
      console.log('Transitioning from', fromScreenId, 'to', toScreenId);

      const fromScreen = document.getElementById(fromScreenId);
      const toScreen = document.getElementById(toScreenId);

      // Verify elements exist
      if (!fromScreen || !toScreen) {
        console.error('Screen elements not found!', fromScreenId, toScreenId);
        alert('Navigation error. Please refresh the page.');
        return;
      }

      // Fade out current screen
      fromScreen.classList.add('fadeOut');

      setTimeout(function() {
        // Hide old screen
        fromScreen.classList.remove('active', 'fadeOut');
        fromScreen.style.display = 'none';
        fromScreen.style.opacity = '0';
        fromScreen.style.visibility = 'hidden';

        // Show new screen - use multiple methods to ensure visibility
        toScreen.style.display = 'block';
        toScreen.style.opacity = '1';
        toScreen.style.visibility = 'visible';
        toScreen.classList.add('active');

        // Scroll to top IMMEDIATELY - multiple methods
        window.scrollTo(0, 0);
        document.documentElement.scrollTop = 0;
        document.body.scrollTop = 0;

        console.log('Transition complete, now showing:', toScreenId);

        // Execute callback if provided
        if (callback) {
          try {
            callback();
          } catch(e) {
            console.error('Callback error:', e);
          }
        }
      }, 500);
    }

    // Accept Challenge
    function acceptChallenge() {
      try {
        console.log('Accept challenge clicked');
        const yesCard = document.querySelector('.choice-card.yes');
        const noCard = document.querySelector('.choice-card.no');

        if (yesCard && noCard) {
          yesCard.classList.add('disappear');
          noCard.classList.add('disappear');
        }

        setTimeout(function() {
          transitionToScreen('landingScreen', 'promoScreen');
        }, 800);
      } catch(e) {
        console.error('Error in acceptChallenge:', e);
        // Fallback - just transition immediately
        transitionToScreen('landingScreen', 'promoScreen');
      }
    }

    // Decline Challenge
    function declineChallenge() {
      const message = "No problem! Feel free to come back when you're ready to take on the challenge.";

      // Create a styled modal instead of alert
      const modal = document.createElement('div');
      modal.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 40px;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        z-index: 10000;
        text-align: center;
        max-width: 400px;
      `;
      modal.innerHTML = `
        <p style="font-size: 1.2rem; color: var(--vysus-green); margin-bottom: 20px;">${message}</p>
        <button onclick="this.parentElement.remove()" style="
          background: linear-gradient(135deg, var(--vysus-neon) 0%, var(--vysus-green) 100%);
          color: white;
          padding: 12px 30px;
          border: none;
          border-radius: 25px;
          font-size: 1rem;
          font-weight: 600;
          cursor: pointer;
        ">OK</button>
      `;
      document.body.appendChild(modal);
    }

    // Start Challenge
    function startChallenge() {
      try {
        console.log('Starting challenge...');
        transitionToScreen('promoScreen', 'quizScreen', function() {
          startTime = Date.now();
          startTimer();
          loadQuestion();
        });
      } catch(e) {
        console.error('Error starting challenge:', e);
        alert('Error starting challenge. Please refresh and try again.');
      }
    }

    // Timer Function
    function startTimer() {
      timerInterval = setInterval(() => {
        const elapsed = Math.floor((Date.now() - startTime) / 1000);
        const minutes = Math.floor(elapsed / 60);
        const seconds = elapsed % 60;
        document.getElementById('quizTimer').textContent =
          `‚è±Ô∏è ${minutes}:${String(seconds).padStart(2, '0')}`;
      }, 1000);
    }

    // Show Encouragement Message
    function showEncouragement(message) {
      const encouragement = document.createElement('div');
      encouragement.className = 'encouragement-message';
      encouragement.textContent = message;
      document.body.appendChild(encouragement);

      setTimeout(() => {
        encouragement.remove();
      }, 2000);
    }

    // Check and Show Encouragement Based on Progress
    function checkEncouragement() {
      const currentPercentage = Math.round((score / totalPossiblePoints) * 100);
      const questionsCompleted = currentQuestion;
      const shouldShowEncouragement = (questionsCompleted - lastEncouragementQuestion) >= 5;

      if (!shouldShowEncouragement) return;

      if (questionsCompleted === 10) {
        showEncouragement("üí™ You're doing great! Keep going!");
        lastEncouragementQuestion = questionsCompleted;
      } else if (questionsCompleted === 20) {
        if (currentPercentage >= 80) {
          showEncouragement("üèÜ Outstanding! You're crushing it!");
        } else if (currentPercentage >= 60) {
          showEncouragement("‚≠ê Solid performance! Almost there!");
        } else {
          showEncouragement("üí™ Keep pushing! You've got this!");
        }
        lastEncouragementQuestion = questionsCompleted;
      } else if (questionsCompleted === 30) {
        showEncouragement("üéØ Final stretch! Finish strong!");
        lastEncouragementQuestion = questionsCompleted;
      } else if (questionsCompleted % 7 === 0 && currentPercentage >= 85) {
        showEncouragement("üî• Exceptional work!");
        lastEncouragementQuestion = questionsCompleted;
      }
    }

    // Load Question
    function loadQuestion() {
      const question = quizData[currentQuestion];

      document.getElementById('questionCounter').textContent = `Question ${currentQuestion + 1} of ${quizData.length}`;
      document.getElementById('scoreQuestionCount').textContent = `Question ${currentQuestion + 1}/${quizData.length}`;
      document.getElementById('progressFill').style.width = `${((currentQuestion + 1) / quizData.length) * 100}%`;
      document.getElementById('categoryBadge').textContent = question.category;

      // Update difficulty badge
      const difficultyBadge = document.getElementById('difficultyBadge');
      difficultyBadge.className = `difficulty-badge ${question.difficulty}`;
      const difficultyIcons = { easy: '‚≠ê', medium: 'üéØ', hard: 'üî•' };
      difficultyBadge.textContent = `${difficultyIcons[question.difficulty]} ${question.points} Points`;

      document.getElementById('questionText').textContent = question.question;

      const answersGrid = document.getElementById('answersGrid');
      answersGrid.innerHTML = '';

      question.answers.forEach(function(answer, index) {
        const answerDiv = document.createElement('div');
        answerDiv.className = 'answer-option';
        answerDiv.onclick = function() { selectAnswer(index); };

        answerDiv.innerHTML = `
          <span class="answer-label">${String.fromCharCode(65 + index)}.</span>
          <span class="answer-text">${answer}</span>
        `;

        answersGrid.appendChild(answerDiv);
      });
    }

    // Select Answer - AUTO-ADVANCE (Gamified Mode)
    function selectAnswer(index) {
      const question = quizData[currentQuestion];
      const isCorrect = index === question.correct;
      const pointsEarned = isCorrect ? question.points : 0;

      userAnswers.push({
        questionIndex: currentQuestion,
        selected: index,
        correct: isCorrect,
        points: pointsEarned
      });

      if (isCorrect) {
        score += pointsEarned;
        showPointPopup(`+${pointsEarned}`);
      }

      document.getElementById('scorePoints').textContent = score.toLocaleString();

      const answerOptions = document.querySelectorAll('.answer-option');
      answerOptions[index].classList.add('selected');

      setTimeout(function() {
        if (currentQuestion < quizData.length - 1) {
          currentQuestion++;
          checkEncouragement();
          loadQuestion();
        } else {
          clearInterval(timerInterval);
          showResults();
        }
      }, 800);
    }

    // Show Point Popup
    function showPointPopup(text) {
      const popup = document.createElement('div');
      popup.className = 'point-popup';
      popup.textContent = text;
      document.body.appendChild(popup);

      setTimeout(() => {
        popup.remove();
      }, 1000);
    }

    // Show Results
    function showResults() {
      const percentage = Math.round((score / totalPossiblePoints) * 100);
      const correctAnswers = userAnswers.filter(a => a.correct).length;
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      const minutes = Math.floor(elapsed / 60);
      const seconds = elapsed % 60;

      transitionToScreen('quizScreen', 'resultsScreen', () => {
        // Populate results after transition
        populateResults(percentage, correctAnswers, minutes, seconds);
      });
    }

    // Populate Results Data
    function populateResults(percentage, correctAnswers, minutes, seconds) {
      const timeSpentStr = `${minutes}:${String(seconds).padStart(2, '0')}`;

      document.getElementById('finalScore').textContent = `${percentage}%`;
      document.getElementById('correctCount').textContent = correctAnswers;
      document.getElementById('totalPoints').textContent = score.toLocaleString();
      document.getElementById('timeSpent').textContent = timeSpentStr;

      // Pre-fill email from access screen
      if (candidateEmail) {
        document.getElementById('candidateEmailResult').value = candidateEmail;
      }

      document.getElementById('candidateScore').value = `${score}/${totalPossiblePoints} points`;
      document.getElementById('candidatePercentage').value = percentage;
      document.getElementById('candidateTimeTaken').value = timeSpentStr;

      // Build answers summary (only letter selections)
      let answersText = '';
      userAnswers.forEach((answer, idx) => {
        const letterChoice = String.fromCharCode(65 + answer.selected);
        answersText += `Q${idx + 1}: ${letterChoice}\n`;
      });
      document.getElementById('candidateAnswers').value = answersText;

      let performanceHTML = '';
      let icon = '';

      if (percentage >= 90) {
        icon = 'üèÜ';
        performanceHTML = `
          <h3>Outstanding Performance - You're Exactly Who We're Looking For!</h3>
          <p>You've scored ${percentage}% - demonstrating exceptional mastery of power systems engineering. Your technical knowledge aligns perfectly with the requirements for our Principal/Lead roles. We'd love to have you on our team.</p>
          <p style="margin-top: 15px;">We strongly encourage you to submit your results below so we can start a conversation about your future with Vysus Group.</p>
        `;
      } else if (percentage >= 80) {
        icon = '‚≠ê';
        performanceHTML = `
          <h3>Excellent Performance - You've Got What It Takes!</h3>
          <p>You've scored ${percentage}% - showing strong technical competency across multiple areas. Your knowledge base is well-suited for our Senior Power Systems Engineer roles, and with the right mentorship, you could quickly advance to Principal level.</p>
          <p style="margin-top: 15px;">We'd love to discuss opportunities with you. Please submit your results below and we'll be in touch.</p>
        `;
      } else if (percentage >= 70) {
        icon = 'üí™';
        performanceHTML = `
          <h3>Strong Foundation - You're On the Right Track!</h3>
          <p>You've scored ${percentage}% - showing solid understanding of power systems fundamentals. With additional hands-on experience in advanced topics like GFM, low SCR environments, and R1/R2 processes, you could be an excellent fit for our team.</p>
          <p style="margin-top: 15px;">We'd like to stay in touch with you. Feel free to submit your results and we can discuss how you can develop into the role.</p>
        `;
      } else if (percentage >= 60) {
        icon = 'üìö';
        performanceHTML = `
          <h3>Good Potential - Keep Building Your Skills!</h3>
          <p>You've scored ${percentage}% - demonstrating promising knowledge in several areas. We recommend gaining more hands-on experience with NER compliance, dynamic simulation software, and grid connection processes. Your foundation is good, but you'll need deeper expertise for our current openings.</p>
          <p style="margin-top: 15px;">You're welcome to submit your results for future consideration as you gain more experience.</p>
        `;
      } else {
        icon = 'üéØ';
        performanceHTML = `
          <h3>Keep Developing Your Expertise!</h3>
          <p>You've scored ${percentage}%. This challenge highlights the advanced technical depth required for grid connection engineering at Vysus Group. We encourage you to continue building your expertise in power systems modeling, NER compliance, and renewable integration.</p>
          <p style="margin-top: 15px;">You're welcome to submit your results and stay connected with our recruitment team. As you gain more experience, we'd love to see you retake the challenge!</p>
        `;
      }

      document.getElementById('resultsIcon').textContent = icon;
      document.getElementById('performanceMessage').innerHTML = performanceHTML;

      // Category breakdown
      const categories = {};
      quizData.forEach((q, i) => {
        if (!categories[q.category]) {
          categories[q.category] = { correct: 0, total: 0 };
        }
        categories[q.category].total++;
        if (userAnswers[i] && userAnswers[i].correct) {
          categories[q.category].correct++;
        }
      });

      let categoryHTML = '';
      let categoryScoresText = '';
      Object.entries(categories).forEach(([name, stats]) => {
        const catPercentage = Math.round((stats.correct / stats.total) * 100);
        categoryScoresText += `${name}: ${catPercentage}% (${stats.correct}/${stats.total})\n`;
        categoryHTML += `
          <div class="category-score">
            <span class="category-name">${name}</span>
            <span class="category-percentage">${catPercentage}% (${stats.correct}/${stats.total})</span>
          </div>
        `;
      });

      document.getElementById('categoryBreakdown').innerHTML = categoryHTML;
      document.getElementById('candidateCategoryScores').value = categoryScoresText;
    }

    // File Upload Handler
    document.addEventListener('DOMContentLoaded', function() {
      const fileInput = document.getElementById('resumeFile');
      if (fileInput) {
        fileInput.addEventListener('change', function(e) {
          const fileName = e.target.files[0]?.name || 'Click to upload your resume (optional)';
          document.getElementById('fileUploadLabel').textContent = `üìé ${fileName}`;
        });
      }
    });

    // Form Submission Handler
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('resultsForm');
      if (form) {
        form.addEventListener('submit', function(e) {
          e.preventDefault();

          const formData = new FormData(this);
          const data = Object.fromEntries(formData.entries());

          // Build answers summary (only letter selections, no questions or correct answers)
          let answersText = '';
          userAnswers.forEach((answer, idx) => {
            const letterChoice = String.fromCharCode(65 + answer.selected);
            answersText += `Q${idx + 1}: ${letterChoice}\n`;
          });

          // Update hidden fields with formatted data
          document.getElementById('candidateAnswers').value = answersText;

          // Try Netlify Forms first
          const netlifyFormData = new FormData(form);

          fetch('/', {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: new URLSearchParams(netlifyFormData).toString()
          })
          .then(response => {
            if (response.ok) {
              // Clear session after successful submission
              sessionStorage.removeItem('vysusSession');

              // Show success message
              showSubmissionSuccess(data.name);
            } else {
              throw new Error('Form submission failed');
            }
          })
          .catch(error => {
            console.log('Netlify form failed, using mailto fallback:', error);
            // Fallback to mailto
            sendViaEmail(data, answersText);
          });
        });
      }
    });

    // Show success message after submission
    function showSubmissionSuccess(name) {
      const submitSection = document.querySelector('.submit-results-section');
      submitSection.innerHTML = `
        <div style="text-align: center; padding: 40px;">
          <div style="font-size: 5rem; margin-bottom: 20px;">‚úÖ</div>
          <h3 style="color: var(--vysus-green); font-size: 2rem; margin-bottom: 15px;">Thank You, ${name}!</h3>
          <p style="font-size: 1.2rem; line-height: 1.8; color: var(--vysus-rock);">
            Your results have been successfully submitted to our recruitment team at Vysus Group.
          </p>
          <p style="font-size: 1.1rem; margin-top: 20px; color: var(--vysus-rock);">
            We will review your performance and be in touch shortly to discuss potential opportunities.
          </p>
          <div style="margin-top: 30px; padding: 20px; background: rgba(0, 227, 169, 0.1); border-radius: 15px; border: 1px solid rgba(0, 227, 169, 0.3);">
            <p style="margin: 0; font-weight: 600; color: var(--vysus-green);">
              üìß Questions? Contact us at <a href="mailto:chris.marinelli@vysusgroup.com" style="color: var(--vysus-neon);">chris.marinelli@vysusgroup.com</a>
            </p>
          </div>
        </div>
      `;
    }

    // Fallback email submission
    function sendViaEmail(data, answersText) {
      const emailSubject = `Vysus Technical Challenge Results - ${data.name} (Score: ${data.percentage}%)`;
      const emailBody = `
Technical Challenge Results Submission

CANDIDATE INFORMATION:
- Name: ${data.name}
- Email: ${data.email}
- Phone: ${data.phone}
- Location: ${data.location}
- Experience: ${data.experience} years
- LinkedIn: ${data.linkedin || 'Not provided'}

CHALLENGE RESULTS:
- Score: ${data.score}
- Percentage: ${data.percentage}%
- Time Taken: ${data.timeTaken}
- Status: ${data.percentage >= 80 ? 'Excellent - Recommended for interview' : 'Good potential - Consider for future roles'}

CANDIDATE ANSWERS (Letter selections only):
${answersText}

CATEGORY BREAKDOWN:
${data.categoryScores}

WHY VYSUS GROUP:
${data.motivation}

---
This candidate completed the Vysus Technical Excellence Assessment.
      `;

      const mailtoLink = `mailto:chris.marinelli@vysusgroup.com?subject=${encodeURIComponent(emailSubject)}&body=${encodeURIComponent(emailBody)}`;

      window.location.href = mailtoLink;

      // Clear session
      sessionStorage.removeItem('vysusSession');

      alert('Your email client has been opened with your challenge results. Please review and send the email to complete your submission.');
    }
  </script>
</body>
</html>
